/*
** Copyright 2007-2024, RTE (https://www.rte-france.com)
** See AUTHORS.txt
** SPDX-License-Identifier: MPL-2.0
** This file is part of Antares-Simulator,
** Adequacy and Performance assessment for interconnected energy networks.
**
** Antares_Simulator is free software: you can redistribute it and/or modify
** it under the terms of the Mozilla Public Licence 2.0 as published by
** the Mozilla Foundation, either version 2 of the License, or
** (at your option) any later version.
**
** Antares_Simulator is distributed in the hope that it will be useful,
** but WITHOUT ANY WARRANTY; without even the implied warranty of
** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
** Mozilla Public Licence 2.0 for more details.
**
** You should have received a copy of the Mozilla Public Licence 2.0
** along with Antares_Simulator. If not, see <https://opensource.org/license/mpl-2-0/>.
*/
#ifndef __SOLVER_VARIABLE_ECONOMY_ALL_H__
#define __SOLVER_VARIABLE_ECONOMY_ALL_H__

#include "antares/solver/variable/variable.h"

#include "../area.h"
#include "../bindConstraints.h"
#include "../commons/hydro.h"
#include "../commons/join.h"
#include "../commons/load.h"
#include "../commons/miscGenMinusRowPSP.h"
#include "../commons/psp.h"
#include "../commons/rowBalance.h"
#include "../commons/solar.h"
#include "../commons/spatial-aggregate.h"
#include "../commons/wind.h"
#include "../setofareas.h"
#include "balance.h"
#include "price.h"

// For General values
#include "avail-dispatchable-generation.h"
#include "dispatchable-generation-margin.h"
#include "dispatchableGeneration.h"
#include "domesticUnsuppliedEnergy.h"
#include "dtgMarginAfterCsr.h"
#include "hydroCost.h"
#include "hydrostorage.h"
#include "inflow.h"
#include "localMatchingRuleViolations.h"
#include "lold.h"
#include "lolp.h"
#include "max-mrg.h"
#include "nbOfDispatchedUnits.h"
#include "nonProportionalCost.h"
#include "operatingCost.h"
#include "overallCost.h"
#include "overflow.h"
#include "pumping.h"
#include "renewableGeneration.h"
#include "reservoirlevel.h"
#include "spilledEnergy.h"
#include "thermalAirPollutantEmissions.h"
#include "unsupliedEnergy.h"
#include "unsupliedEnergyCsr.h"
#include "waterValue.h"

// By thermal plant
#include "nbOfDispatchedUnitsByPlant.h"
#include "npCostByDispatchablePlant.h"
#include "productionByDispatchablePlant.h"
#include "profitByPlant.h"

// By RES plant
#include "STSbyGroup.h"
#include "STStorageCashFlowByCluster.h"
#include "STStorageInjectionByCluster.h"
#include "STStorageLevelsByCluster.h"
#include "STStorageWithdrawalByCluster.h"
#include "productionByRenewablePlant.h"

// Output variables associated to links
#include "links.h"

// Output variables associated to binding constraints
#include "bindingConstraints/bindingConstraintsMarginalCost.h"

namespace Antares::Solver::Variable::Economy
{

/*!
** \brief All variables for a single area (economy)
*/
typedef          // Prices
  OverallCost    // Overall Cost (Op. Cost + Unsupplied Eng.)
  <OperatingCost // Operating Cost
   <Price        // Marginal price                                  // Thermal pollutants
    <ThermalAirPollutantEmissions      // Overall pollutant emissions(from all thermal dispatchable
                                       // clusters) Production by thermal cluster
     <ProductionByDispatchablePlant    // Energy generated by thermal dispatchable clusters
      <ProductionByRenewablePlant      // Energy generated by renewable clusters (must-run)
       <Balance                        // Nodal Energy Balance
                                       // Misc Gen.
        <RowBalance                    // Misc Gen. Row balance
         <PSP                          // PSP
          <MiscGenMinusRowPSP          // Misc Gen. - Row Balance - PSP
                                       // Time series
           <TimeSeriesValuesLoad       // Load
            <TimeSeriesValuesHydro     // Hydro
             <TimeSeriesValuesWind     // Wind
              <TimeSeriesValuesSolar   // Solar
                                       // Other
               <DispatchableGeneration // All dispatchable generation
                <RenewableGeneration   // All renewable generation
                 <HydroStorage         // Hydro Storage Generation
                  <Pumping             // Pumping generation
                   <ReservoirLevel     // Reservoir levels
                    <Inflows           // Hydraulic inflows
                     <Overflows        // Hydraulic overflows
                      <WaterValue      // Water values
                       <HydroCost      // Hydro costs
                                       // <ShortTermStorageByGroup
                        <STSbyGroup<STstorageInjectionByCluster<STstorageWithdrawalByCluster<
                          STstorageLevelsByCluster<STstorageCashFlowByCluster<
                            UnsupliedEnergy           // Unsuplied Energy
                            <DomesticUnsuppliedEnergy // Domestic Unsupplied Energy
                             <LMRViolations           // LMR Violations
                              <SpilledEnergy          // Spilled Energy
                               <LOLD                  // LOLD
                                <LOLP                 // LOLP
                                 <AvailableDispatchGen<DispatchableGenMargin<DtgMarginCsr< // DTG
                                                                                           // MRG
                                                                                           // CSR
                                   UnsupliedEnergyCSR< // Unsupplied energy after CSR
                                     Marge<NonProportionalCost<
                                       NonProportionalCostByDispatchablePlant // Startup cost +
                                                                              // Fixed cost per
                                                                              // thermal plant
                                                                              // detail
                                       <NbOfDispatchedUnits         // Number of Units Dispatched
                                        <NbOfDispatchedUnitsByPlant // Number of Units Dispatched
                                                                    // by plant
                                         <ProfitByPlant
                                          // Links
                                          <Variable::Economy::Links // All links
                                           >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    VariablesPerArea;

/*!
** \brief All variables for a single set of areas (economy)
*/
typedef // Prices
  Common::SpatialAggregate<
    OverallCost,
    Common::SpatialAggregate<
      OperatingCost,
      Common::SpatialAggregate<
        Price,
        // Thermal pollutants
        Common::SpatialAggregate<
          ThermalAirPollutantEmissions,
          // Production by thermal cluster
          Common::SpatialAggregate<
            Balance,
            // Misc Gen.
            Common::SpatialAggregate<
              RowBalance,
              Common::SpatialAggregate<
                PSP,
                Common::SpatialAggregate<
                  MiscGenMinusRowPSP,
                  // Time series
                  Common::SpatialAggregate<
                    TimeSeriesValuesLoad,
                    Common::SpatialAggregate<
                      TimeSeriesValuesHydro,
                      Common::SpatialAggregate<
                        TimeSeriesValuesWind,
                        Common::SpatialAggregate<
                          TimeSeriesValuesSolar,
                          // Other
                          Common::SpatialAggregate<
                            DispatchableGeneration,
                            Common::SpatialAggregate<
                              RenewableGeneration,
                              Common::SpatialAggregate<
                                HydroStorage,
                                Common::SpatialAggregate<
                                  Pumping,
                                  Common::SpatialAggregate<
                                    ReservoirLevel,
                                    Common::SpatialAggregate<
                                      Inflows,
                                      Common::SpatialAggregate<
                                        Overflows,
                                        Common::SpatialAggregate<
                                          WaterValue,
                                          Common::SpatialAggregate<
                                            HydroCost,
                                            Common::SpatialAggregate<
                                              UnsupliedEnergy,
                                              Common::SpatialAggregate<
                                                DomesticUnsuppliedEnergy,
                                                Common::SpatialAggregate<
                                                  LMRViolations,
                                                  Common::SpatialAggregate<
                                                    SpilledEnergy,
                                                    // LOLD
                                                    Common::SpatialAggregate<
                                                      LOLD,
                                                      Common::SpatialAggregate<
                                                        LOLP,
                                                        Common::SpatialAggregate<
                                                          AvailableDispatchGen,
                                                          Common::SpatialAggregate<
                                                            DispatchableGenMargin,
                                                            Common::SpatialAggregate<
                                                              DtgMarginCsr,
                                                              Common::SpatialAggregate<
                                                                Marge,

                                                                // Detail Prices
                                                                Common::SpatialAggregate<
                                                                  NonProportionalCost, // MBO
                                                                                       // 13/05/2014
                                                                                       // -
                                                                                       // refs:
                                                                                       // #21

                                                                  // Number Of Dispatched Units
                                                                  Common::SpatialAggregate<
                                                                    NbOfDispatchedUnits // MBO
                                                                                        // 25/02/2016
                                                                                        // -
                                                                                        // refs:
                                                                                        // #55
                                                                    >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    VariablesPerSetOfAreas;

typedef BindingConstMarginCost< // Marginal cost for a binding constraint
  Container::EndOfList          // End of variable list
  >

  VariablesPerBindingConstraints;

typedef Variable::Join<
  // Variables for each area / links attached to the areas
  Variable::Areas<VariablesPerArea>,
  // Variables for each set of areas
  Variable::Join<Variable::SetsOfAreas<VariablesPerSetOfAreas>,
                 // Variables for each binding constraint
                 Variable::BindingConstraints<VariablesPerBindingConstraints>>>
  ItemList;

/*!
** \brief All variables for a simulation (economy)
*/
typedef Container::List<ItemList> AllVariables;

} // namespace Antares::Solver::Variable::Economy

#endif // __SOLVER_VARIABLE_ECONOMY_ALL_H__
